<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Advanced Program and Policy Evaluation (HPOL8539)</title>
<link>https://graveja0.github.io/HPOL8539-F2022/blog/index.html</link>
<atom:link href="https://graveja0.github.io/HPOL8539-F2022/blog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.0.36</generator>
<lastBuildDate>Tue, 23 Aug 2022 17:40:31 GMT</lastBuildDate>
<item>
  <title>A post!</title>
  <link>https://graveja0.github.io/HPOL8539-F2022/blog/posts/post1.html</link>
  <description><![CDATA[ 



<p>This is a post!</p>



 ]]></description>
  <guid>https://graveja0.github.io/HPOL8539-F2022/blog/posts/post1.html</guid>
  <pubDate>Tue, 23 Aug 2022 17:40:31 GMT</pubDate>
</item>
<item>
  <title>second post</title>
  <link>https://graveja0.github.io/HPOL8539-F2022/blog/posts/post2.html</link>
  <description><![CDATA[ 



<p>National Harbor<sup>1</sup> is a census-designated place (CDP) in Prince George’s County, Maryland, United States, located along the Potomac River near the Woodrow Wilson Bridge and just south of Washington. It originated as a 300-acre (1.2 km2) multi-use waterfront development. Per the 2020 census, the population was 5,509.</p>
<section id="development" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="development">Development</h2>
<p>The Gaylord National Resort &amp; Convention Center at National Harbor opened on April 1, 2008 in Oxon Hill, Maryland. The site is being developed by Milton Peterson’s Peterson Companies with the project expected to cost well over $2 billion, and a construction time frame of 2007 to late 2014. As of April 2016 construction was continuing and the cost was set at $4 billion. In 2010, the development was designated as a census-designated place.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Reasons to go:</p>
<ol type="1">
<li>Ferris wheel</li>
<li>Ferris wheel</li>
</ol>
</div></div><div class="callout-warning callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Gaylord National Resort
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be prepared for the massive scale of the atrium which has a mini-version of a town <em>inside</em> it.</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://en.wikipedia.org/wiki/National_Harbor,_Maryland"><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/https:/upload.wikimedia.org/wikipedia/commons/thumb/a/a5/GaylordNationalResort.jpg/500px-GaylordNationalResort.jpg" alt="A aerial photograph of Gaylord National Resort" width="400" height="400" class="figure-img"></a></p>
</figure>
</div>
<section id="disney" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="disney">Disney</h3>
<p>The land developed for National Harbor was previously Salubria Plantation, built in 1827 by Dr.&nbsp;John H. Bayne. The plantation house burned down in 1981 and was offered for sale along with the surrounding land. The land was sold in 1984 and in 1994 was rezoned for mixed-use development. In the fall of 1997, the Maryland Department of the Environment and the Army Corps of Engineers approved new developer permits, granted for the PortAmerica project in 1988.</p>
<div id="fig-ferris" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-main" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/https:/upload.wikimedia.org/wikipedia/commons/thumb/7/7d/National_Harbor_Aerial718.jpg/440px-National_Harbor_Aerial718.jpg" class="img-fluid figure-img" data-ref-parent="fig-ferris"></p>
<p></p><figcaption class="figure-caption">(a) View from Virginia.</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-far" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/https:/upload.wikimedia.org/wikipedia/commons/thumb/a/af/National_Harbor_Aerial420.jpg/440px-National_Harbor_Aerial420.jpg" class="img-fluid figure-img" data-ref-parent="fig-ferris"></p>
<p></p><figcaption class="figure-caption">(b) View from the air.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-close" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/https:/upload.wikimedia.org/wikipedia/commons/thumb/9/91/Capital_Wheel_at_National_Harbor%252C_Maryland%252C_USA.jpg/500px-Capital_Wheel_at_National_Harbor%252C_Maryland%252C_USA.jpg" class="img-fluid figure-img" data-ref-parent="fig-ferris"></p>
<p></p><figcaption class="figure-caption">(c) View from the promenade.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure 1: Three views of the ferris wheel.</figcaption><p></p>
</figure>
</div>
<p>Here’s a big version of one of those images!</p>
<div class="column-screen">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/https:/upload.wikimedia.org/wikipedia/commons/thumb/9/91/Capital_Wheel_at_National_Harbor%252C_Maryland%252C_USA.jpg/2560px-Capital_Wheel_at_National_Harbor%252C_Maryland%252C_USA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A BIG view from the promenade.</figcaption><p></p>
</figure>
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>the text content and images are all from the Wikipedia page linked above.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://graveja0.github.io/HPOL8539-F2022/blog/posts/post2.html</guid>
  <pubDate>Tue, 23 Aug 2022 17:40:31 GMT</pubDate>
  <media:content url="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/GaylordNationalResort.jpg/500px-GaylordNationalResort.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Simulate DID Data</title>
  <link>https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited.html</link>
  <description><![CDATA[ 



<div class="cell">

</div>
<div class="cell">

</div>
<section id="plot-data" class="level2">
<h2 class="anchored" data-anchor-id="plot-data">Plot Data</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extended-twfe-model" class="level2">
<h2 class="anchored" data-anchor-id="extended-twfe-model">Extended TWFE Model</h2>
<p>The problem I’m running into here is as follows. In a panel where there is a later treated unit (e.g., 2007) there should be no interactions with years at or above this. The problem is that when I run it this way, the constant term that is fit in Stata is not fit in R,so the coefficients are off. Only if I allow for these interactions will the coefficients be correct for the <em>first</em> treated groups, but not the latter.</p>
<p>Maybe see <a href="https://www.statalist.org/forums/forum/general-stata-discussion/general/630290-interpreting-the-constant-in-reghdfe">here</a>?</p>
<section id="debugging" class="level3">
<h3 class="anchored" data-anchor-id="debugging">Debugging</h3>
</section>
<section id="structuring-the-data" class="level3">
<h3 class="anchored" data-anchor-id="structuring-the-data">Structuring the data</h3>
<ul>
<li>Need to only make interactions between group (<code>treatment_time</code>) and time (<code>year</code>) where <code>year&gt;treatment_time</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># This data frame is structured to use not-yet-treated groups as controls.</span></span>
<span id="cb1-2"></span>
<span id="cb1-3">df_etwfe6 <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb1-4">  data6 <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(treatment_time,year), <span class="cf" style="color: #003B4F;">function</span>(x) <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(x))) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">max_treat =</span> <span class="fu" style="color: #4758AB;">max</span>(treatment_time, <span class="at" style="color: #657422;">na.rm=</span><span class="cn" style="color: #8f5902;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-7">  <span class="co" style="color: #5E5E5E;"># DROP ALL OBSERVATIONS THAT AREN'T iDENTIFIED</span></span>
<span id="cb1-8">  <span class="fu" style="color: #4758AB;">filter</span>(year <span class="sc" style="color: #5E5E5E;">&lt;</span> max_treat) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year_lt_treatment_time =</span> <span class="fu" style="color: #4758AB;">as.integer</span>(year <span class="sc" style="color: #5E5E5E;">&lt;</span> treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>(year <span class="sc" style="color: #5E5E5E;">&gt;=</span> treatment_time <span class="sc" style="color: #5E5E5E;">~</span> year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-11">  <span class="co" style="color: #5E5E5E;">#mutate(year_tmp = case_when(year &gt;= treatment_time &amp; year &lt; max(treatment_time,na.rm=TRUE) ~ year)) %&gt;%  THIS IS THE PROBLEMATIC LINE</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>(year <span class="sc" style="color: #5E5E5E;">&gt;=</span> treatment_time <span class="sc" style="color: #5E5E5E;">~</span> treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">is.na</span>(treatment_time),<span class="dv" style="color: #AD0000;">0</span>,treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time),</span>
<span id="cb1-15">         <span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">factor</span>(year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time_tmp),</span>
<span id="cb1-17">         <span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(year_tmp)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span>   </span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">interaction</span>(treat,treatment_time_tmp,year_tmp,<span class="at" style="color: #657422;">sep=</span><span class="st" style="color: #20794D;">":"</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">paste0</span>(i)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;">dummy_cols</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-21">  janitor<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">clean_names</span>() </span></code></pre></div>
</div>
<section id="all-groups-eventually-treated" class="level4">
<h4 class="anchored" data-anchor-id="all-groups-eventually-treated">All Groups Eventually Treated</h4>
<p>Using group fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;">#1a  jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  group</span></span>
<span id="cb2-2">fmla1a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6),value=TRUE),collapse = '+')} | treatment_time + year"</span>))</span>
<span id="cb2-3">fmla1a</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dep_var ~ i_1_1989_1989 + i_1_1989_1990 + i_1_1989_1991 + i_1_1989_1992 + 
    i_1_1989_1993 + i_1_1989_1994 + i_1_1989_1995 + i_1_1989_1996 + 
    i_1_1989_1997 + i_1_1989_1998 + i_1_1989_1999 + i_1_1989_2000 + 
    i_1_1989_2001 + i_1_1989_2002 + i_1_1989_2003 + i_1_1989_2004 + 
    i_1_1989_2005 + i_1_1989_2006 + i_1_1998_1998 + i_1_1998_1999 + 
    i_1_1998_2000 + i_1_1998_2001 + i_1_1998_2002 + i_1_1998_2003 + 
    i_1_1998_2004 + i_1_1998_2005 + i_1_1998_2006 | treatment_time + 
    year</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">fit1a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla1a,df_etwfe6); fit1a</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: dep_var
Observations: 5,508 
Fixed-effects: treatment_time: 3,  year: 27
Standard-errors: Clustered (treatment_time) 
              Estimate Std. Error   t value   Pr(&gt;|t|)    
i_1_1989_1989 0.550551   0.083236   6.61432 2.2103e-02 *  
i_1_1989_1990 1.097450   0.029460  37.25211 7.1983e-04 ***
i_1_1989_1991 1.649690   0.032895  50.14942 3.9738e-04 ***
i_1_1989_1992 2.091558   0.018832 111.06601 8.1056e-05 ***
i_1_1989_1993 2.706269   0.044696  60.54856 2.7266e-04 ***
i_1_1989_1994 3.117833   0.009088 343.06036 8.4968e-06 ***
i_1_1989_1995 3.548997   0.005236 677.86613 2.1763e-06 ***
i_1_1989_1996 4.190584   0.008500 493.02953 4.1139e-06 ***
... 19 coefficients remaining (display them with summary() or use argument n)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 1.55415     Adj. R2: 0.688456
                Within R2: 0.433584</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">est1a <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;">tidy</span>(fit1a) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - Group FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span>
<span id="cb6-8">    </span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;">stata</span>(<span class="st" style="color: #20794D;">"jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  group"</span>, <span class="at" style="color: #657422;">data.in =</span> data6 <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(year,treatment_time),<span class="cf" style="color: #003B4F;">function</span>(x) <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(x))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>. jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  group
WARNING: Singleton observations not dropped; statistical significance is biased
&gt;  (link)
(MWFE estimator converged in 2 iterations)

HDFE Linear regression                            Number of obs   =      5,508
Absorbing 2 HDFE groups                           F(  27,    199) =      29.74
Statistics robust to heteroskedasticity           Prob &gt; F        =     0.0000
                                                  R-squared       =     0.6916
                                                  Adj R-squared   =     0.6885
                                                  Within R-sq.    =     0.4336
Number of clusters (unit)    =        200         Root MSE        =     1.5621

                                 (Std. Err. adjusted for 200 clusters in unit)
------------------------------------------------------------------------------
             |               Robust
     dep_var |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treatment_~e#|
        year#|
    c.__tr__ |
  1989 1989  |   .5505505   .0856819     6.43   0.000     .3815895    .7195116
  1989 1990  |    1.09745   .1012055    10.84   0.000     .8978769    1.297023
  1989 1991  |    1.64969   .0984294    16.76   0.000     1.455591    1.843788
  1989 1992  |   2.091558   .1270886    16.46   0.000     1.840945    2.342172
  1989 1993  |   2.706269   .1405392    19.26   0.000     2.429132    2.983406
  1989 1994  |   3.117833   .1547081    20.15   0.000     2.812755     3.42291
  1989 1995  |   3.548997   .1871525    18.96   0.000      3.17994    3.918054
  1989 1996  |   4.190584   .2031831    20.62   0.000     3.789915    4.591252
  1989 1997  |   4.560902   .2223433    20.51   0.000      4.12245    4.999353
  1989 1998  |   5.274783   .2381306    22.15   0.000     4.805199    5.744366
  1989 1999  |   5.799933   .2777758    20.88   0.000     5.252171    6.347695
  1989 2000  |    6.12532   .2842315    21.55   0.000     5.564828    6.685812
  1989 2001  |   6.657937   .3127127    21.29   0.000     6.041281    7.274593
  1989 2002  |   7.132307   .3291643    21.67   0.000      6.48321    7.781405
  1989 2003  |   7.846859   .3622341    21.66   0.000     7.132549    8.561169
  1989 2004  |   8.352164    .380407    21.96   0.000     7.602018     9.10231
  1989 2005  |   8.761887   .3908817    22.42   0.000     7.991085    9.532689
  1989 2006  |   9.213217   .4329893    21.28   0.000     8.359381    10.06705
  1998 1998  |   .4548369   .0974278     4.67   0.000     .2627134    .6469604
  1998 1999  |   .6896868   .0978636     7.05   0.000      .496704    .8826696
  1998 2000  |   .8477485   .1120189     7.57   0.000     .6268522    1.068645
  1998 2001  |   1.223767   .1228332     9.96   0.000     .9815457    1.465989
  1998 2002  |   1.424722   .1439758     9.90   0.000     1.140808    1.708637
  1998 2003  |    1.89068   .1665003    11.36   0.000     1.562349    2.219011
  1998 2004  |    2.13663   .1823018    11.72   0.000     1.777139    2.496121
  1998 2005  |   2.578458   .2068636    12.46   0.000     2.170532    2.986384
  1998 2006  |   2.820769   .2196635    12.84   0.000     2.387602    3.253936
             |
       _cons |  -.0060328   .0754332    -0.08   0.936    -.1547838    .1427183
------------------------------------------------------------------------------

Absorbed degrees of freedom:
--------------------------------------------------------+
    Absorbed FE | Categories  - Redundant  = Num. Coefs |
----------------+---------------------------------------|
 treatment_time |         3           0           3     |
           year |        27           1          26     |
--------------------------------------------------------+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">est1a <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">kable</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">group</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">att</th>
<th style="text-align: left;">estimator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1989</td>
<td style="text-align: right;">0.5505505</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1990</td>
<td style="text-align: right;">1.0974499</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1991</td>
<td style="text-align: right;">1.6496898</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1992</td>
<td style="text-align: right;">2.0915583</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1993</td>
<td style="text-align: right;">2.7062687</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1994</td>
<td style="text-align: right;">3.1178326</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1995</td>
<td style="text-align: right;">3.5489970</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1996</td>
<td style="text-align: right;">4.1905836</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">4.5609016</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1998</td>
<td style="text-align: right;">5.2747825</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">5.7999327</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">6.1253203</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">6.6579370</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">7.1323074</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">7.8468588</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">8.3521641</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">8.7618869</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">9.2132170</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">1998</td>
<td style="text-align: right;">0.4548369</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">0.6896868</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">0.8477485</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">1.2237674</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">1.4247225</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">1.8906801</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">2.1366302</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">2.5784581</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">2.8207688</td>
<td style="text-align: left;">ETWFE - Group FE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Using unit fixed effects – this one runs into p</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;">#2b jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time) </span></span>
<span id="cb9-2">fmla1b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6),value=TRUE),collapse = '+')} | unit + year"</span>))</span>
<span id="cb9-3">fit1b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla1b,df_etwfe6)</span>
<span id="cb9-4"></span>
<span id="cb9-5">est1b <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;">tidy</span>(fit1b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - Unit FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span></code></pre></div>
</div>
</section>
<section id="only-use-a-never-treated-group-as-control" class="level4">
<h4 class="anchored" data-anchor-id="only-use-a-never-treated-group-as-control">Only Use a Never Treated Group as Control</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">df_etwfe6b <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb10-2">  data6b <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(treatment_time,year), <span class="cf" style="color: #003B4F;">function</span>(x) <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(x))) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-4">  </span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;">group_by</span>(treatment_time) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;">arrange</span>(treatment_time,year) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">first_year =</span> <span class="fu" style="color: #4758AB;">as.integer</span>(<span class="fu" style="color: #4758AB;">row_number</span>()<span class="sc" style="color: #5E5E5E;">==</span><span class="dv" style="color: #AD0000;">1</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-8">  </span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">is.na</span>(treatment_time),<span class="dv" style="color: #AD0000;">0</span>,treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-10">  </span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>(year <span class="sc" style="color: #5E5E5E;">&gt;=</span> treatment_time  <span class="sc" style="color: #5E5E5E;">~</span> year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>(year <span class="sc" style="color: #5E5E5E;">&gt;=</span> treatment_time<span class="sc" style="color: #5E5E5E;">~</span> treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-13">  </span>
<span id="cb10-14"> </span>
<span id="cb10-15">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time),</span>
<span id="cb10-16">         <span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">factor</span>(year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-17">  </span>
<span id="cb10-18">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time_tmp),</span>
<span id="cb10-19">         <span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(year_tmp)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span>   </span>
<span id="cb10-20">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">interaction</span>(treat,treatment_time_tmp,year_tmp,<span class="at" style="color: #657422;">sep=</span><span class="st" style="color: #20794D;">":"</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-21">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">paste0</span>(i)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;">dummy_cols</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb10-23">  janitor<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">clean_names</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-24">  <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>i_na)</span>
<span id="cb10-25"></span>
<span id="cb10-26"></span>
<span id="cb10-27"></span>
<span id="cb10-28"><span class="co" style="color: #5E5E5E;"># This data frame is structured to only use never-treated groups as controls. </span></span>
<span id="cb10-29">df_etwfe6b_nt <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb10-30">  data6b <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-31">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(treatment_time,year), <span class="cf" style="color: #003B4F;">function</span>(x) <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(x))) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-32">  </span>
<span id="cb10-33">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treat =</span> <span class="dv" style="color: #AD0000;">1</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-34">  </span>
<span id="cb10-35">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">is.na</span>(treatment_time),<span class="dv" style="color: #AD0000;">0</span>,treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-36">  </span>
<span id="cb10-37">  <span class="fu" style="color: #4758AB;">group_by</span>(treatment_time) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-38">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">first_year =</span> <span class="fu" style="color: #4758AB;">as.integer</span>(year <span class="sc" style="color: #5E5E5E;">==</span> <span class="fu" style="color: #4758AB;">min</span>(year,<span class="at" style="color: #657422;">na.rm=</span><span class="cn" style="color: #8f5902;">TRUE</span>))) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-39">  <span class="fu" style="color: #4758AB;">ungroup</span>()  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-40">  <span class="co" style="color: #5E5E5E;"># mutate(year_tmp = year,</span></span>
<span id="cb10-41">         <span class="co" style="color: #5E5E5E;"># treatment_time_tmp = treatment_time) %&gt;% </span></span>
<span id="cb10-42">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>(first_year<span class="sc" style="color: #5E5E5E;">!=</span><span class="dv" style="color: #AD0000;">1</span>  <span class="sc" style="color: #5E5E5E;">~</span> year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-43"></span>
<span id="cb10-44">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">case_when</span>( first_year <span class="sc" style="color: #5E5E5E;">!=</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">~</span> treatment_time)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-45">    </span>
<span id="cb10-46"></span>
<span id="cb10-47">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time_tmp),</span>
<span id="cb10-48">         <span class="at" style="color: #657422;">year_tmp =</span> <span class="fu" style="color: #4758AB;">factor</span>(year_tmp)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span>   </span>
<span id="cb10-49">  </span>
<span id="cb10-50">    </span>
<span id="cb10-51">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">factor</span>(treatment_time),</span>
<span id="cb10-52">         <span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">factor</span>(year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-53">  </span>
<span id="cb10-54">  </span>
<span id="cb10-55">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">interaction</span>(treat,treatment_time_tmp,year_tmp,<span class="at" style="color: #657422;">sep=</span><span class="st" style="color: #20794D;">":"</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-56">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">i =</span> <span class="fu" style="color: #4758AB;">paste0</span>(i)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-57">  <span class="fu" style="color: #4758AB;">dummy_cols</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb10-58">  janitor<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">clean_names</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-59">  <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span><span class="fu" style="color: #4758AB;">contains</span>(<span class="st" style="color: #20794D;">"i_1_0_"</span>))</span>
<span id="cb10-60"></span>
<span id="cb10-61"><span class="fu" style="color: #4758AB;">grep</span>(<span class="st" style="color: #20794D;">'i_1_'</span>,<span class="fu" style="color: #4758AB;">colnames</span>(df_etwfe6b_nt),<span class="at" style="color: #657422;">value=</span><span class="cn" style="color: #8f5902;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "i_1_1989_1981" "i_1_1989_1982" "i_1_1989_1983" "i_1_1989_1984"
 [5] "i_1_1989_1985" "i_1_1989_1986" "i_1_1989_1987" "i_1_1989_1988"
 [9] "i_1_1989_1989" "i_1_1989_1990" "i_1_1989_1991" "i_1_1989_1992"
[13] "i_1_1989_1993" "i_1_1989_1994" "i_1_1989_1995" "i_1_1989_1996"
[17] "i_1_1989_1997" "i_1_1989_1998" "i_1_1989_1999" "i_1_1989_2000"
[21] "i_1_1989_2001" "i_1_1989_2002" "i_1_1989_2003" "i_1_1989_2004"
[25] "i_1_1989_2005" "i_1_1989_2006" "i_1_1989_2007" "i_1_1989_2008"
[29] "i_1_1989_2009" "i_1_1989_2010" "i_1_1989_2011" "i_1_1989_2012"
[33] "i_1_1989_2013" "i_1_1989_2014" "i_1_1989_2015" "i_1_1998_1981"
[37] "i_1_1998_1982" "i_1_1998_1983" "i_1_1998_1984" "i_1_1998_1985"
[41] "i_1_1998_1986" "i_1_1998_1987" "i_1_1998_1988" "i_1_1998_1989"
[45] "i_1_1998_1990" "i_1_1998_1991" "i_1_1998_1992" "i_1_1998_1993"
[49] "i_1_1998_1994" "i_1_1998_1995" "i_1_1998_1996" "i_1_1998_1997"
[53] "i_1_1998_1998" "i_1_1998_1999" "i_1_1998_2000" "i_1_1998_2001"
[57] "i_1_1998_2002" "i_1_1998_2003" "i_1_1998_2004" "i_1_1998_2005"
[61] "i_1_1998_2006" "i_1_1998_2007" "i_1_1998_2008" "i_1_1998_2009"
[65] "i_1_1998_2010" "i_1_1998_2011" "i_1_1998_2012" "i_1_1998_2013"
[69] "i_1_1998_2014" "i_1_1998_2015"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;">#2a  jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  group</span></span>
<span id="cb12-2">fmla2a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6b),value=TRUE),collapse = '+')} | treatment_time + year"</span>))</span>
<span id="cb12-3">fmla2a</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dep_var ~ i_1_1989_1989 + i_1_1989_1990 + i_1_1989_1991 + i_1_1989_1992 + 
    i_1_1989_1993 + i_1_1989_1994 + i_1_1989_1995 + i_1_1989_1996 + 
    i_1_1989_1997 + i_1_1989_1998 + i_1_1989_1999 + i_1_1989_2000 + 
    i_1_1989_2001 + i_1_1989_2002 + i_1_1989_2003 + i_1_1989_2004 + 
    i_1_1989_2005 + i_1_1989_2006 + i_1_1989_2007 + i_1_1989_2008 + 
    i_1_1989_2009 + i_1_1989_2010 + i_1_1989_2011 + i_1_1989_2012 + 
    i_1_1989_2013 + i_1_1989_2014 + i_1_1989_2015 + i_1_1998_1998 + 
    i_1_1998_1999 + i_1_1998_2000 + i_1_1998_2001 + i_1_1998_2002 + 
    i_1_1998_2003 + i_1_1998_2004 + i_1_1998_2005 + i_1_1998_2006 + 
    i_1_1998_2007 + i_1_1998_2008 + i_1_1998_2009 + i_1_1998_2010 + 
    i_1_1998_2011 + i_1_1998_2012 + i_1_1998_2013 + i_1_1998_2014 + 
    i_1_1998_2015 | treatment_time + year</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">fit2a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla2a,df_etwfe6b)</span>
<span id="cb14-2">est2a <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;">tidy</span>(fit2a) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb14-7">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - Group FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb14-8">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span>
<span id="cb14-9"></span>
<span id="cb14-10"><span class="co" style="color: #5E5E5E;">#2b  jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  </span></span>
<span id="cb14-11">fmla2b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6b),value=TRUE),collapse = '+')} | unit + year"</span>))</span>
<span id="cb14-12">fmla2b</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dep_var ~ i_1_1989_1989 + i_1_1989_1990 + i_1_1989_1991 + i_1_1989_1992 + 
    i_1_1989_1993 + i_1_1989_1994 + i_1_1989_1995 + i_1_1989_1996 + 
    i_1_1989_1997 + i_1_1989_1998 + i_1_1989_1999 + i_1_1989_2000 + 
    i_1_1989_2001 + i_1_1989_2002 + i_1_1989_2003 + i_1_1989_2004 + 
    i_1_1989_2005 + i_1_1989_2006 + i_1_1989_2007 + i_1_1989_2008 + 
    i_1_1989_2009 + i_1_1989_2010 + i_1_1989_2011 + i_1_1989_2012 + 
    i_1_1989_2013 + i_1_1989_2014 + i_1_1989_2015 + i_1_1998_1998 + 
    i_1_1998_1999 + i_1_1998_2000 + i_1_1998_2001 + i_1_1998_2002 + 
    i_1_1998_2003 + i_1_1998_2004 + i_1_1998_2005 + i_1_1998_2006 + 
    i_1_1998_2007 + i_1_1998_2008 + i_1_1998_2009 + i_1_1998_2010 + 
    i_1_1998_2011 + i_1_1998_2012 + i_1_1998_2013 + i_1_1998_2014 + 
    i_1_1998_2015 | unit + year</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">fit2b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla2b,df_etwfe6b)</span>
<span id="cb16-2">est2b <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;">tidy</span>(fit2b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-5">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - Unit FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-8">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)<span class="co" style="color: #5E5E5E;">#2b  jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time)  </span></span>
<span id="cb16-9">fmla2b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6b),value=TRUE),collapse = '+')} | unit + year"</span>))</span>
<span id="cb16-10">fmla2b</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dep_var ~ i_1_1989_1989 + i_1_1989_1990 + i_1_1989_1991 + i_1_1989_1992 + 
    i_1_1989_1993 + i_1_1989_1994 + i_1_1989_1995 + i_1_1989_1996 + 
    i_1_1989_1997 + i_1_1989_1998 + i_1_1989_1999 + i_1_1989_2000 + 
    i_1_1989_2001 + i_1_1989_2002 + i_1_1989_2003 + i_1_1989_2004 + 
    i_1_1989_2005 + i_1_1989_2006 + i_1_1989_2007 + i_1_1989_2008 + 
    i_1_1989_2009 + i_1_1989_2010 + i_1_1989_2011 + i_1_1989_2012 + 
    i_1_1989_2013 + i_1_1989_2014 + i_1_1989_2015 + i_1_1998_1998 + 
    i_1_1998_1999 + i_1_1998_2000 + i_1_1998_2001 + i_1_1998_2002 + 
    i_1_1998_2003 + i_1_1998_2004 + i_1_1998_2005 + i_1_1998_2006 + 
    i_1_1998_2007 + i_1_1998_2008 + i_1_1998_2009 + i_1_1998_2010 + 
    i_1_1998_2011 + i_1_1998_2012 + i_1_1998_2013 + i_1_1998_2014 + 
    i_1_1998_2015 | unit + year</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">fit2b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla2b,df_etwfe6b)</span>
<span id="cb18-2">est2b <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;">tidy</span>(fit2b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-6">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-7">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - Unit FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-8">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span>
<span id="cb18-9"></span>
<span id="cb18-10"></span>
<span id="cb18-11"></span>
<span id="cb18-12"></span>
<span id="cb18-13"><span class="do" style="color: #5E5E5E;
font-style: italic;">## NEED TO GET RID OF ONE MORE CATEGORY (1998 x 1980)</span></span>
<span id="cb18-14"><span class="co" style="color: #5E5E5E;">#2c  jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time) group never</span></span>
<span id="cb18-15">fmla2c <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6b_nt),value=TRUE),collapse = '+')} | treatment_time + year"</span>))</span>
<span id="cb18-16">fit2c <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla2c,df_etwfe6b_nt)</span>
<span id="cb18-17">est2c <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb18-18">  <span class="fu" style="color: #4758AB;">tidy</span>(fit2c) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-19">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-20">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-21">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-22">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - NT Cx - Group FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-23">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span>
<span id="cb18-24"></span>
<span id="cb18-25"><span class="co" style="color: #5E5E5E;">#2d jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time) never !!!! THIS ONE SEEMS TO BE WRONG IN STATA ... </span></span>
<span id="cb18-26">fmla2d <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.formula</span>(<span class="fu" style="color: #4758AB;">glue</span>(<span class="st" style="color: #20794D;">"dep_var ~ {paste0(grep('i_1_',colnames(df_etwfe6b_nt),value=TRUE),collapse = '+')} | unit + year"</span>))</span>
<span id="cb18-27">fit2d <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">feols</span>(fmla2d,df_etwfe6b_nt <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">unit =</span> <span class="fu" style="color: #4758AB;">factor</span>(unit)))</span>
<span id="cb18-28">est2d <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb18-29">  <span class="fu" style="color: #4758AB;">tidy</span>(fit2d) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-30">  <span class="fu" style="color: #4758AB;">separate</span>(term, <span class="at" style="color: #657422;">into =</span><span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"tmp"</span>,<span class="st" style="color: #20794D;">"tmp2"</span>,<span class="st" style="color: #20794D;">"group"</span>,<span class="st" style="color: #20794D;">"year"</span>))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-31">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">att =</span> estimate) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-32">  <span class="fu" style="color: #4758AB;">select</span>(group, year , att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-33">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"ETWFE - NT Cx - Unit FE"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-34">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(group,year), as.numeric)</span>
<span id="cb18-35"></span>
<span id="cb18-36"><span class="fu" style="color: #4758AB;">stata</span>(<span class="st" style="color: #20794D;">"</span></span>
<span id="cb18-37"><span class="st" style="color: #20794D;">      replace treatment_time = 0 if treatment_time==.</span></span>
<span id="cb18-38"><span class="st" style="color: #20794D;">      jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time) never</span></span>
<span id="cb18-39"><span class="st" style="color: #20794D;">      "</span>, <span class="at" style="color: #657422;">data.in =</span> data6b <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">vars</span>(year,treatment_time),<span class="cf" style="color: #003B4F;">function</span>(x) <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(x))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>. 
.       replace treatment_time = 0 if treatment_time==.
(2,304 real changes made)
.       jwdid  dep_var , ivar(unit) tvar(year) gvar(treatment_time) never
WARNING: Singleton observations not dropped; statistical significance is biased
&gt;  (link)
(MWFE estimator converged in 2 iterations)

HDFE Linear regression                            Number of obs   =      7,344
Absorbing 2 HDFE groups                           F(  70,    199) =      11.60
Statistics robust to heteroskedasticity           Prob &gt; F        =     0.0000
                                                  R-squared       =     0.8801
                                                  Adj R-squared   =     0.8749
                                                  Within R-sq.    =     0.6290
Number of clusters (unit)    =        200         Root MSE        =     1.5535

                                 (Std. Err. adjusted for 200 clusters in unit)
------------------------------------------------------------------------------
             |               Robust
     dep_var |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treatment_~e#|
        year#|
    c.__tr__ |
  1989 1981  |  -1.547624   .7704777    -2.01   0.046    -3.066972   -.0282756
  1989 1982  |  -1.584289   .7772889    -2.04   0.043    -3.117069   -.0515092
  1989 1983  |  -1.642049   .7722397    -2.13   0.035    -3.164872   -.1192261
  1989 1984  |   -1.43341   .7549454    -1.90   0.059     -2.92213    .0553095
  1989 1985  |  -1.535311   .7726244    -1.99   0.048    -3.058893   -.0117291
  1989 1986  |  -1.648764   .7700177    -2.14   0.033    -3.167206    -.130323
  1989 1987  |  -1.481473   .7525563    -1.97   0.050    -2.965481    .0025358
  1989 1988  |  -1.518695   .7756531    -1.96   0.052    -3.048249    .0108597
  1989 1989  |  -.9574712   .7657142    -1.25   0.213    -2.467426     .552484
  1989 1990  |  -.3574772   .7526876    -0.47   0.635    -1.841744     1.12679
  1989 1991  |    .140598   .7517545     0.19   0.852    -1.341829    1.623025
  1989 1992  |   .6721532   .7727109     0.87   0.385    -.8515991    2.195905
  1989 1993  |   1.184797   .7764752     1.53   0.129    -.3463783    2.715972
  1989 1994  |   1.657065   .7854902     2.11   0.036     .1081125    3.206018
  1989 1995  |   2.168771   .7807311     2.78   0.006     .6292032    3.708339
  1989 1996  |   2.744621   .7966587     3.45   0.001     1.173644    4.315597
  1989 1997  |   3.236545    .802859     4.03   0.000     1.653342    4.819748
  1989 1998  |   3.702205   .8068537     4.59   0.000     2.111125    5.293285
  1989 1999  |    4.24945   .8216235     5.17   0.000     2.629244    5.869656
  1989 2000  |    4.81904   .8267467     5.83   0.000     3.188732    6.449349
  1989 2001  |   5.289953   .8324853     6.35   0.000     3.648329    6.931578
  1989 2002  |   5.852231   .8518576     6.87   0.000     4.172404    7.532057
  1989 2003  |    6.35007   .8571423     7.41   0.000     4.659822    8.040317
  1989 2004  |   6.756413    .880549     7.67   0.000     5.020009    8.492818
  1989 2005  |   7.538427   .8896723     8.47   0.000     5.784031    9.292822
  1989 2006  |   7.972006   .9043422     8.82   0.000     6.188682    9.755329
  1989 2007  |   8.576618   .9269071     9.25   0.000     6.748798    10.40444
  1989 2008  |   9.029933    .938673     9.62   0.000     7.178911    10.88096
  1989 2009  |   9.555117    .956706     9.99   0.000     7.668534     11.4417
  1989 2010  |   10.06048   .9658729    10.42   0.000     8.155825    11.96514
  1989 2011  |   10.58318   .9875133    10.72   0.000     8.635846    12.53051
  1989 2012  |    11.1655   1.003004    11.13   0.000     9.187621    13.14338
  1989 2013  |   11.69397   1.012015    11.56   0.000     9.698322    13.68962
  1989 2014  |   12.21836   1.044331    11.70   0.000     10.15898    14.27773
  1989 2015  |   12.81408    1.06626    12.02   0.000     10.71146    14.91669
  1998 1981  |  -2.891191     1.4403    -2.01   0.046    -5.731399   -.0509824
  1998 1982  |  -2.889899   1.438253    -2.01   0.046    -5.726071   -.0537267
  1998 1983  |    -2.9394   1.426655    -2.06   0.041    -5.752702   -.1260988
  1998 1984  |  -2.876048   1.426257    -2.02   0.045    -5.688565   -.0635305
  1998 1985  |  -2.842289   1.438295    -1.98   0.050    -5.678544   -.0060341
  1998 1986  |  -2.990234   1.422831    -2.10   0.037    -5.795996   -.1844721
  1998 1987  |   -2.71098   1.413242    -1.92   0.057    -5.497833    .0758717
  1998 1988  |   -2.78655   1.437245    -1.94   0.054    -5.620734    .0476345
  1998 1989  |  -2.832501    1.43221    -1.98   0.049    -5.656757   -.0082451
  1998 1990  |  -2.759115   1.420724    -1.94   0.054     -5.56072    .0424909
  1998 1991  |  -2.883721   1.399811    -2.06   0.041    -5.644088    -.123354
  1998 1992  |  -2.804369   1.423898    -1.97   0.050    -5.612234    .0034966
  1998 1993  |  -2.774502    1.41303    -1.96   0.051    -5.560936    .0119319
  1998 1994  |   -2.81939   1.425141    -1.98   0.049    -5.629705   -.0090743
  1998 1995  |  -2.815639   1.411897    -1.99   0.047    -5.599839   -.0314392
  1998 1996  |  -2.779294   1.440586    -1.93   0.055    -5.620068    .0614789
  1998 1997  |  -2.658515    1.43755    -1.85   0.066    -5.493302    .1762725
  1998 1998  |  -2.547614   1.415547    -1.80   0.073    -5.339012    .2437835
  1998 1999  |  -2.204368   1.404752    -1.57   0.118    -4.974479    .5657427
  1998 2000  |  -2.044966    1.40235    -1.46   0.146    -4.810338    .7204066
  1998 2001  |  -1.790538   1.391114    -1.29   0.200    -4.533754    .9526785
  1998 2002  |  -1.368831   1.383051    -0.99   0.324    -4.096148    1.358486
  1998 2003  |  -.9809712   1.370899    -0.72   0.475    -3.684325    1.722382
  1998 2004  |  -.7812189   1.377396    -0.57   0.571    -3.497384    1.934946
  1998 2005  |  -.3232407   1.389143    -0.23   0.816    -3.062571    2.416089
  1998 2006  |  -.1415136   1.365938    -0.10   0.918    -2.835083    2.552056
  1998 2007  |   .2364609   1.367123     0.17   0.863    -2.459446    2.932368
  1998 2008  |    .671513   1.368328     0.49   0.624    -2.026771    3.369797
  1998 2009  |   .8786274   1.373172     0.64   0.523    -1.829208    3.586462
  1998 2010  |   1.156292   1.368928     0.84   0.399    -1.543175    3.855758
  1998 2011  |     1.4396   1.375672     1.05   0.297    -1.273165    4.152365
  1998 2012  |   1.768957    1.35629     1.30   0.194    -.9055885    4.443502
  1998 2013  |   1.911296   1.353292     1.41   0.159    -.7573372    4.579929
  1998 2014  |   2.354145   1.354785     1.74   0.084    -.3174335    5.025723
  1998 2015  |   2.775042   1.364392     2.03   0.043     .0845195    5.465565
             |
       _cons |   1.455016   .7264596     2.00   0.047     .0224693    2.887563
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        unit |       200         200           0    *|
        year |        36           1          35     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
.       </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="estimate-cs" class="level2">
<h2 class="anchored" data-anchor-id="estimate-cs">Estimate CS</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">data6_cs <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb20-2">  data6 <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(year)),</span>
<span id="cb20-4">         <span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(treatment_time)))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">is.na</span>(treatment_time),<span class="dv" style="color: #AD0000;">0</span>,treatment_time))</span>
<span id="cb20-6">  </span>
<span id="cb20-7"></span>
<span id="cb20-8">fit_cs6 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">att_gt</span>(<span class="at" style="color: #657422;">yname =</span> <span class="st" style="color: #20794D;">"dep_var"</span>,</span>
<span id="cb20-9">                        <span class="at" style="color: #657422;">tname =</span> <span class="st" style="color: #20794D;">"year"</span>,</span>
<span id="cb20-10">                        <span class="at" style="color: #657422;">idname =</span> <span class="st" style="color: #20794D;">"unit"</span>,</span>
<span id="cb20-11">                        <span class="at" style="color: #657422;">gname =</span> <span class="st" style="color: #20794D;">"treatment_time"</span>,</span>
<span id="cb20-12">                        <span class="at" style="color: #657422;">control_group =</span> <span class="st" style="color: #20794D;">"notyettreated"</span>,</span>
<span id="cb20-13">                        <span class="at" style="color: #657422;">data =</span> data6_cs</span>
<span id="cb20-14">                        )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pre_process_did(yname = yname, tname = tname, idname = idname, :
Dropped 4 observations while converting to balanced panel.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">est_cs6 <span class="ot" style="color: #003B4F;">&lt;-</span>  <span class="fu" style="color: #4758AB;">tibble</span>(<span class="at" style="color: #657422;">group =</span> fit_cs6<span class="sc" style="color: #5E5E5E;">$</span>group, <span class="at" style="color: #657422;">year =</span> fit_cs6<span class="sc" style="color: #5E5E5E;">$</span>t, <span class="at" style="color: #657422;">att =</span> fit_cs6<span class="sc" style="color: #5E5E5E;">$</span>att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"CS"</span>) </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">data6b_cs <span class="ot" style="color: #003B4F;">&lt;-</span> </span>
<span id="cb23-2">  data6b <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb23-3">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(year)),</span>
<span id="cb23-4">         <span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(<span class="fu" style="color: #4758AB;">paste0</span>(treatment_time)))  <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb23-5">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">treatment_time =</span> <span class="fu" style="color: #4758AB;">ifelse</span>(<span class="fu" style="color: #4758AB;">is.na</span>(treatment_time),<span class="dv" style="color: #AD0000;">0</span>,treatment_time))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mask$eval_all_mutate(quo): NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">fit_cs6b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">att_gt</span>(<span class="at" style="color: #657422;">yname =</span> <span class="st" style="color: #20794D;">"dep_var"</span>,</span>
<span id="cb25-2">                        <span class="at" style="color: #657422;">tname =</span> <span class="st" style="color: #20794D;">"year"</span>,</span>
<span id="cb25-3">                        <span class="at" style="color: #657422;">idname =</span> <span class="st" style="color: #20794D;">"unit"</span>,</span>
<span id="cb25-4">                        <span class="at" style="color: #657422;">gname =</span> <span class="st" style="color: #20794D;">"treatment_time"</span>,</span>
<span id="cb25-5">                        <span class="at" style="color: #657422;">control_group =</span> <span class="st" style="color: #20794D;">"nevertreated"</span>,</span>
<span id="cb25-6">                        <span class="at" style="color: #657422;">data =</span> data6b_cs</span>
<span id="cb25-7">                        )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pre_process_did(yname = yname, tname = tname, idname = idname, :
Dropped 4 observations while converting to balanced panel.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">est_cs6b <span class="ot" style="color: #003B4F;">&lt;-</span>  <span class="fu" style="color: #4758AB;">tibble</span>(<span class="at" style="color: #657422;">group =</span> fit_cs6b<span class="sc" style="color: #5E5E5E;">$</span>group, <span class="at" style="color: #657422;">year =</span> fit_cs6b<span class="sc" style="color: #5E5E5E;">$</span>t, <span class="at" style="color: #657422;">att =</span> fit_cs6b<span class="sc" style="color: #5E5E5E;">$</span>att) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb27-2">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">estimator =</span> <span class="st" style="color: #20794D;">"CS"</span>)</span></code></pre></div>
</div>
</section>
<section id="compare" class="level2">
<h2 class="anchored" data-anchor-id="compare">Compare</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">est1a <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est1b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est_cs6) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb28-4">  <span class="fu" style="color: #4758AB;">ggplot</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> year, <span class="at" style="color: #657422;">y =</span> att, <span class="at" style="color: #657422;">colour =</span> <span class="fu" style="color: #4758AB;">factor</span>(group), <span class="at" style="color: #657422;">pch =</span> estimator)) <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb28-5">  <span class="fu" style="color: #4758AB;">geom_point</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb28-6">  <span class="fu" style="color: #4758AB;">theme_clean</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb28-7">  ggsci<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">scale_color_aaas</span>() </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">est2a <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est2b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est2c) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est2d) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb29-5">  <span class="fu" style="color: #4758AB;">bind_rows</span>(est_cs6b) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb29-6">  <span class="fu" style="color: #4758AB;">ggplot</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> year, <span class="at" style="color: #657422;">y =</span> att, <span class="at" style="color: #657422;">colour =</span> <span class="fu" style="color: #4758AB;">factor</span>(group), <span class="at" style="color: #657422;">pch =</span> estimator)) <span class="sc" style="color: #5E5E5E;">+</span> </span>
<span id="cb29-7">  <span class="fu" style="color: #4758AB;">geom_point</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb29-8">  <span class="fu" style="color: #4758AB;">theme_clean</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb29-9">  ggsci<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">scale_color_aaas</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb29-10">  <span class="co" style="color: #5E5E5E;">#scale_shape_manual(values =c(19,4,3)) +</span></span>
<span id="cb29-11">  <span class="fu" style="color: #4758AB;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;">~</span>group)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><a href="https://friosavila.github.io/playingwithstata/main_jwdid.html">Source</a></p>
<p><a href="https://jonathandroth.github.io/assets/files/DiD_Review_Paper.pdf">Review paper</a></p>
<p><a href="https://twitter.com/jmwooldridge/status/1374555518623178757?lang=en">Wooldridge</a></p>


</section>

 ]]></description>
  <guid>https://graveja0.github.io/HPOL8539-F2022/blog/posts/did-revisited.html</guid>
  <pubDate>Tue, 23 Aug 2022 17:40:31 GMT</pubDate>
</item>
</channel>
</rss>
